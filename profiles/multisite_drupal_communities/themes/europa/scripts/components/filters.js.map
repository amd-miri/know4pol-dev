{"version":3,"sources":["components/filters.js"],"names":["filters","refineText","hideText","clearAll","exposedBlockId","_this","this","$filters","jQuery","$filtersSubmit","filtersFormId","find","attr","$resultsCount","$itemsNumber","oldIE","is","hideFilterButtons","hide","showFilterButtons","show","length","append","on","trigger","once","throbber","document","ajaxStart","e","currentTarget","activeElement","form","id","prepend","enquire","register","match","$filtersWrapper","addClass","removeClass","removeAttr","children","remove","unwrap","unmatch","wrapInner","setup","window","width","click","hasClass","collapse","Drupal","behaviors","europa_filters","attach","t","settings","europa"],"mappings":"CAAC,WACC,YAMA,SAASA,GAAQC,EAAYC,EAAUC,EAAUC,GAC/C,GAAIC,GAAQC,KAERC,EAAWC,OAAO,YAClBC,EAAiBD,OAAO,uBAAwBD,GAChDG,EAAgBH,EAASI,KAAK,QAAQC,KAAK,MAC3CC,EAAgBL,OAAO,0BACvBM,EAAeN,OAAO,0BAGtBO,GAAQ,CACRP,QAAO,QAAQQ,GAAG,UACpBD,GAAQ,EAIV,IAAIE,GAAoB,WACtBT,OAAO,sDAAsDU,QAG3DC,EAAoB,WACtBX,OAAO,sDAAsDY,OAI3DP,GAAcG,GAAG,cAAgBR,OAAO,0BAA0Ba,QACpER,EAAcS,OAAO,yIAA2InB,EAAW,oJAAsJC,EAAiB,kFAAoFH,EAAa,qCAKrbO,OAAO,8BAA8Be,GAAG,QAAS,WAC/Cf,OAAO,uBAAuBgB,QAAQ,WAKxCjB,EAASkB,KAAK,UAAW,WACvB,GAAIC,GAAW,0HACflB,QAAOmB,UAAUC,UAAU,SAAUC,GACQ,cAAvCA,EAAEC,cAAcC,cAAcC,MAAwBH,EAAEC,cAAcC,cAAcC,KAAKC,KAAOvB,GAClGI,EAAaoB,QAAQR,KAIF,mBAAZS,UAETA,QAAQC,SAAS,iCAEfC,MAAO,WACL,GAAIC,GAAkB9B,OAAO,oBAE7BC,GAAe8B,SAAS,4BAGxBhC,EAASiC,YAAY,YAAYD,SAAS,eAAe3B,KAAK,iBAAiB,GAAM6B,WAAW,SAGhGxB,IAEAV,EAASmC,SAAS,UAAUC,SACxBL,EAAgBjB,QAClBiB,EAAgBI,WAAWE,OAAO,yCAItCC,QAAS,WAEP1B,IAEAZ,EAASuC,UAAU,wCACnBvC,EAASiC,YAAY,eAAeD,SAAS,YAAY3B,KAAK,iBAAiB,GAE/EH,EAAe+B,YAAY,6BAG7BO,MAAO,WAEDvC,OAAOwC,QAAQC,QAAU,IAC3B1C,EAASiC,YAAY,YAAYD,SAAS,eAAe3B,KAAK,iBAAiB,GAAM6B,WAAW,SAEhGlC,EAASgC,SAAS,YAEpB9B,EAAe+B,YAAY,4BAC3BjC,EAASuC,UAAU,wCAEd/B,GACHN,EAAeyC,MAAM,WACdzC,EAAe0C,SAAS,6BAC3B5C,EAAS6C,SAAS,UAKxB7C,EAASgB,GAAG,mBAAoB,WAC9Bf,OAAOH,GAAO6B,QAAQ,yGAA2G9B,EAAiB,6FAA+FF,EAAW,wBAC5Pe,MAGFV,EAASgB,GAAG,mBAAoB,WAC9Bf,OAAOH,GAAOqC,SAAS,UAAUC,SACjCxB,WASZkC,OAAOC,UAAUC,gBACfC,OAAQ,WACN,MAAOxD,GAAQqD,OAAOI,EAAE,UAAWJ,OAAOI,EAAE,QAASJ,OAAOI,EAAE,aAAcJ,OAAOK,SAASC,OAAOvD","file":"components/filters.js","sourcesContent":["(function () {\n  'use strict';\n\n  /**\n   * Exposed filter related behaviors.\n   */\n\n  function filters(refineText, hideText, clearAll, exposedBlockId) {\n    var _this = this;\n\n    var $filters = jQuery('.filters');\n    var $filtersSubmit = jQuery('.filters__btn-submit', $filters);\n    var filtersFormId = $filters.find('form').attr('id');\n    var $resultsCount = jQuery('.filters__result-count');\n    var $itemsNumber = jQuery('.filters__items-number');\n\n    // Checking if IE8 is used.\n    var oldIE = false;\n    if (jQuery('html').is('.ie8')) {\n      oldIE = true;\n    }\n\n    // Function for hiding Submit and Reset buttons.\n    var hideFilterButtons = function hideFilterButtons() {\n      jQuery('.filters__btn-collapse, .filters__btn-reset--small').hide();\n    };\n\n    var showFilterButtons = function showFilterButtons() {\n      jQuery('.filters__btn-collapse, .filters__btn-reset--small').show();\n    };\n\n    // Adding buttons for the filters.\n    if ($resultsCount.is(':visible') && !jQuery('.filters__btn-collapse').length) {\n      $resultsCount.append('\\n      <div class=\"btn-group\">\\n        <button class=\"btn btn-default filters__btn-reset--small hidden js-showonsubmit\">\\n          ' + clearAll + '\\n        </button>\\n        <button class=\"btn btn-primary filters__btn-collapse\" type=\"button\"\\n          data-toggle=\"collapse\" data-target=\"#' + exposedBlockId + '\"\\n          aria-expanded=\"false\" aria-controls=\"collapseFilters\">\\n          ' + refineText + '\\n        </button>\\n      </div>');\n    }\n\n    // Listeners.\n    // Small button emulating the original reset button.\n    jQuery('.filters__btn-reset--small').on('click', function () {\n      jQuery('.filters__btn-reset').trigger('click');\n    });\n\n    // Runs only once.\n    // Add throbber next to content type and items count text.\n    $filters.once('filters', function () {\n      var throbber = '<div class=\"ajax-progress ajax-progress-throbber\">\\n        <i class=\"icon icon--spinner is-spinning\"></i>\\n      </div>';\n      jQuery(document).ajaxStart(function (e) {\n        if (e.currentTarget.activeElement.form === 'undefined' && e.currentTarget.activeElement.form.id === filtersFormId) {\n          $itemsNumber.prepend(throbber);\n        }\n      });\n\n      if (typeof enquire !== 'undefined') {\n        // Runs on device width change.\n        enquire.register('screen and (min-width: 992px)', {\n          // Desktop.\n          match: function match() {\n            var $filtersWrapper = jQuery('.filters__wrapper');\n\n            $filtersSubmit.addClass('ctools-auto-submit-click');\n\n            // Opening filters when changing to desktop.\n            $filters.removeClass('collapse').addClass('collapse in').attr('aria-expanded', true).removeAttr('style');\n\n            // Hiding filter buttons.\n            hideFilterButtons();\n\n            $filters.children('.close').remove();\n            if ($filtersWrapper.length) {\n              $filtersWrapper.children().unwrap('<div class=\"filters__wrapper\"></div>');\n            }\n          },\n          // Mobile.\n          unmatch: function unmatch() {\n            // Showing buttons on viewport switch.\n            showFilterButtons();\n\n            $filters.wrapInner('<div class=\"filters__wrapper\"></div>');\n            $filters.removeClass('collapse in').addClass('collapse').attr('aria-expanded', false);\n\n            $filtersSubmit.removeClass('ctools-auto-submit-click');\n          },\n\n          setup: function setup() {\n            // IE8 fix - showing the element containing the filters.\n            if (jQuery(window).width() > 991) {\n              $filters.removeClass('collapse').addClass('collapse in').attr('aria-expanded', true).removeAttr('style');\n            } else {\n              $filters.addClass('collapse');\n            }\n            $filtersSubmit.removeClass('ctools-auto-submit-click');\n            $filters.wrapInner('<div class=\"filters__wrapper\"></div>');\n\n            if (!oldIE) {\n              $filtersSubmit.click(function () {\n                if (!$filtersSubmit.hasClass('ctools-auto-submit-click')) {\n                  $filters.collapse('hide');\n                }\n              });\n            }\n\n            $filters.on('show.bs.collapse', function () {\n              jQuery(_this).prepend('\\n              <a class=\"close filters__close\" data-toggle=\"collapse\"\\n                data-target=\"#' + exposedBlockId + '\"\\n                aria-expanded=\"true\" aria-controls=\"collapseFilters\">\\n                ' + hideText + '\\n              </a>');\n              hideFilterButtons();\n            });\n\n            $filters.on('hide.bs.collapse', function () {\n              jQuery(_this).children('.close').remove();\n              showFilterButtons();\n            });\n          }\n        });\n      }\n    });\n  }\n\n  // Filters\n  Drupal.behaviors.europa_filters = {\n    attach: function attach() {\n      return filters(Drupal.t('Refine'), Drupal.t('Hide'), Drupal.t('Clear all'), Drupal.settings.europa.exposedBlockId);\n    }\n  };\n\n}());\n//# sourceMappingURL=filters.js.map"],"sourceRoot":"../src/"}